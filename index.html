<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DARK FOLLOWERS VIP - OFFICIAL</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Orbitron:wght@400;600;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>

    <style>
        :root { 
            --main-color: #00f2fe; 
            --second-color: #4facfe; 
            --bg-dark: #05070a; 
            --card-bg: #0d1117; 
            --text-color: #e6edf3; 
            --accent: #00ff88; 
            --gold: #ffd700;
            --danger: #ff4d4d;
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }

        body { 
            background: var(--bg-dark); 
            color: var(--text-color); 
            direction: rtl; 
            overflow-x: hidden;
            background-image: radial-gradient(circle at 50% -20%, #0a192f, transparent);
        }

        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .auth-container { 
            position: fixed; inset: 0; background: var(--bg-dark); z-index: 10000; 
            display: flex; justify-content: center; align-items: center; padding: 20px;
        }
        .auth-card { 
            background: rgba(13, 17, 23, 0.8); backdrop-filter: blur(20px); 
            padding: 40px; border-radius: 40px; border: 1px solid var(--glass-border); 
            width: 100%; max-width: 420px; text-align: center;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8);
        }
        .auth-card h1 { font-family: 'Orbitron'; font-size: 28px; color: var(--main-color); margin-bottom: 30px; }

        header { 
            background: linear-gradient(145deg, #161b22, #0d1117); 
            margin: 20px; padding: 30px; border-radius: 35px; border: 1px solid var(--glass-border);
            text-align: center; position: relative; box-shadow: 0 15px 40px rgba(0,0,0,0.5);
        }
        .balance-title { font-size: 14px; color: #8b949e; margin-bottom: 5px; font-weight: bold; }
        .balance-amount { font-family: 'Orbitron'; font-size: 50px; color: var(--main-color); text-shadow: 0 0 20px rgba(0,242,254,0.4); }

        .main-actions { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 0 20px; margin-bottom: 30px; }
        .action-item { 
            background: var(--card-bg); padding: 20px 10px; border-radius: 25px; 
            border: 1px solid var(--glass-border); text-align: center; cursor: pointer; 
            transition: 0.4s;
        }
        .action-item:hover { border-color: var(--main-color); transform: translateY(-5px); background: rgba(0,242,254,0.05); }
        .action-item i { font-size: 28px; color: var(--main-color); margin-bottom: 10px; display: block; }
        .action-item span { font-size: 12px; font-weight: bold; }

        .order-section { 
            background: var(--card-bg); margin: 20px; padding: 30px; border-radius: 35px;
            border: 1px solid var(--glass-border);
        }
        .section-title { font-size: 18px; font-weight: bold; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .section-title i { color: var(--main-color); }

        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-size: 13px; color: #8b949e; padding-right: 10px; }
        input, select { 
            width: 100%; padding: 18px; background: #05070a; border: 1px solid var(--glass-border); 
            border-radius: 18px; color: #fff; font-size: 15px; outline: none; transition: 0.3s;
        }
        input:focus { border-color: var(--main-color); box-shadow: 0 0 15px rgba(0,242,254,0.1); }

        .price-display { 
            background: rgba(0, 255, 136, 0.05); border: 1px dashed var(--accent); 
            padding: 20px; border-radius: 20px; text-align: center; margin: 20px 0;
        }
        .price-display span { font-family: 'Orbitron'; font-size: 28px; color: var(--accent); font-weight: 900; }

        .submit-btn { 
            width: 100%; padding: 20px; background: linear-gradient(90deg, var(--second-color), var(--main-color));
            border: none; border-radius: 20px; color: #000; font-weight: 900; font-size: 18px;
            cursor: pointer; box-shadow: 0 10px 25px rgba(0,242,254,0.3);
        }

        .leaderboard { background: var(--card-bg); margin: 20px; padding: 25px; border-radius: 30px; border: 1px solid var(--gold); }
        .leader-row { 
            display: flex; justify-content: space-between; padding: 12px 15px; 
            background: rgba(255,255,255,0.03); border-radius: 15px; margin-bottom: 10px; 
        }

        .modal-overlay { 
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 9000; 
            display: none; justify-content: center; align-items: center; padding: 20px; backdrop-filter: blur(10px);
        }
        .modal-content { 
            background: var(--card-bg); width: 100%; max-width: 450px; border-radius: 35px;
            padding: 30px; border: 1px solid var(--main-color); position: relative;
        }

        .side-menu { 
            position: fixed; top: 0; right: -300px; width: 300px; height: 100%; 
            background: #0d1117; z-index: 9500; transition: 0.5s cubic-bezier(0.7, 0, 0.3, 1);
            border-left: 1px solid var(--main-color); box-shadow: -10px 0 50px rgba(0,0,0,0.5);
        }
        .side-menu.active { right: 0; }

        .menu-item { 
            padding: 20px 30px; border-bottom: 1px solid rgba(255,255,255,0.05); 
            display: flex; align-items: center; gap: 15px; cursor: pointer;
        }
        .menu-item:hover { background: rgba(0,242,254,0.05); color: var(--main-color); }

        .admin-panel { border: 2px solid var(--danger); }
        .admin-btn { background: #1a1f26; color: #fff; padding: 15px; margin-bottom: 10px; border-radius: 15px; width: 100%; border: 1px solid #333; }

        #toast { 
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); 
            background: var(--main-color); color: #000; padding: 15px 30px; border-radius: 50px; 
            font-weight: bold; transition: 0.5s; z-index: 10001; 
        }
        #toast.show { transform: translateX(-50%) translateY(0); }

        .floating-menu-btn { position: fixed; top: 20px; left: 20px; z-index: 9000; cursor: pointer; color: var(--main-color); font-size: 25px; }
    </style>
</head>
<body>

    <div id="toast">ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­ âœ…</div>

    <div class="floating-menu-btn" onclick="toggleMenu()"><i class="fas fa-bars-staggered"></i></div>

    <div id="authScreen" class="auth-container">
        <div class="auth-card fade-in">
            <i class="fas fa-user-shield fa-4x" style="color:var(--main-color); margin-bottom:20px;"></i>
            <h1 id="authTitle">DARK FOLLOWERS</h1>
            <div id="loginForm">
                <div class="input-group"><input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"></div>
                <div class="input-group"><input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"></div>
                <button class="submit-btn" onclick="login()">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù† ğŸ”‘</button>
                <p style="margin-top:20px; font-size:13px; color:#8b949e">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <span onclick="switchAuth(true)" style="color:var(--main-color); cursor:pointer">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</span></p>
            </div>
            <div id="registerForm" style="display:none;">
                <div class="input-group"><input type="text" id="regName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„"></div>
                <div class="input-group"><input type="email" id="regEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"></div>
                <div class="input-group"><input type="password" id="regPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"></div>
                <button class="submit-btn" onclick="register()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ ğŸš€</button>
                <p style="margin-top:20px; font-size:13px; color:#8b949e">Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ <span onclick="switchAuth(false)" style="color:var(--main-color); cursor:pointer">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</span></p>
            </div>
        </div>
    </div>

    <div id="sideMenu" class="side-menu">
        <div style="padding: 40px 20px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1);">
            <i class="fas fa-crown fa-3x" style="color:var(--gold); margin-bottom:15px;"></i>
            <h3 id="sideUserName">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h3>
            <p id="sideUserID" style="font-size:11px; color:#8b949e; margin-top:5px;"></p>
        </div>
        <div class="menu-item" onclick="openModal('rechargeModal')"><i class="fas fa-wallet"></i> Ø´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯</div>
        <div class="menu-item" onclick="openModal('ordersModal')"><i class="fas fa-list-ul"></i> Ø³Ø¬Ù„ Ø·Ù„Ø¨Ø§ØªÙŠ</div>
        <div class="menu-item" onclick="openModal('transferModal')"><i class="fas fa-exchange-alt"></i> ØªØ­ÙˆÙŠÙ„ Ø±ØµÙŠØ¯</div>
        <div class="menu-item" onclick="window.location.href='https://t.me/lRAQ97'"><i class="fab fa-telegram-plane"></i> Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>
        <div class="menu-item" onclick="logout()" style="color:var(--danger); margin-top:50px;"><i class="fas fa-sign-out-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</div>
    </div>

    <div id="mainContent" style="display:none; padding-bottom: 50px;">
        <header class="fade-in">
            <div class="balance-title">Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
            <div class="balance-amount" id="balanceText">$0.00</div>
            <div style="display:flex; justify-content:center; gap:10px; margin-top:20px;">
                <button onclick="claimDailyBonus()" id="bonusBtn" style="background:var(--gold); color:#000; border:none; padding:10px 25px; border-radius:15px; font-weight:bold; cursor:pointer;">ğŸ Ø¨ÙˆÙ†Øµ ÙŠÙˆÙ…ÙŠ</button>
            </div>
        </header>

        <div class="main-actions fade-in">
            <div class="action-item" onclick="openModal('rechargeModal')"><i class="fas fa-plus-circle"></i><span>Ø´Ø­Ù†</span></div>
            <div class="action-item" onclick="openModal('ordersModal')"><i class="fas fa-clock-rotate-left"></i><span>Ø³Ø¬Ù„</span></div>
            <div class="action-item" onclick="window.location.href='https://t.me/lRAQ97'"><i class="fab fa-telegram"></i><span>Ù‚Ù†Ø§ØªÙ†Ø§</span></div>
            <div class="action-item" onclick="openModal('referralModal')"><i class="fas fa-users-viewfinder"></i><span>Ø¥Ø­Ø§Ù„Ø©</span></div>
        </div>

        <div class="order-section fade-in">
            <div class="section-title"><i class="fas fa-shopping-cart"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</div>
            <div class="input-group">
                <label>Ø§Ù„Ù…Ù†ØµØ©</label>
                <select id="platformSelect" onchange="updateServicesList()">
                    <option value="tiktok">ØªÙŠÙƒ ØªÙˆÙƒ</option>
                    <option value="instagram">Ø§Ù†Ø³ØªÙ‚Ø±Ø§Ù…</option>
                    <option value="telegram">ØªÙ„ÙŠØ¬Ø±Ø§Ù…</option>
                    <option value="youtube">ÙŠÙˆØªÙŠÙˆØ¨</option>
                </select>
            </div>
            <div class="input-group">
                <label>Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</label>
                <select id="serviceSelect" onchange="updatePrice()"></select>
            </div>
            <div class="input-group">
                <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø´ÙˆØ±</label>
                <input type="url" id="orderLink" placeholder="https://...">
            </div>
            <div class="input-group">
                <label>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                <input type="number" id="orderQty" placeholder="Ù…Ø«Ù„Ø§Ù‹: 1000" oninput="updatePrice()">
            </div>
            <div class="price-display">
                <div style="font-size:12px; color:#8b949e; margin-bottom:5px;">Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</div>
                <span>$</span><span id="totalPrice">0.00</span>
            </div>
            <button class="submit-btn" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€</button>
        </div>

        <div class="leaderboard fade-in">
            <div class="section-title"><i class="fas fa-crown" style="color:var(--gold)"></i> ÙƒØ¨Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
            <div id="leaderList"></div>
        </div>

        <div id="adminPanel" class="order-section admin-panel" style="display:none;">
            <div class="section-title" style="color:var(--danger)"><i class="fas fa-user-gear"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (ÙˆØµÙˆÙ„ Ø¢Ù…Ù† ğŸ›¡ï¸)</div>
            <button class="admin-btn" onclick="showAdminSection('adminUsersList')">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
            <button class="admin-btn" onclick="showAdminSection('adminRechargesList')">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</button>
            <button class="admin-btn" onclick="showAdminSection('adminOrdersList')">ÙƒØ§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
            <div id="adminUsersList" style="display:none; margin-top:20px;"></div>
            <div id="adminRechargesList" style="display:none; margin-top:20px;"></div>
            <div id="adminOrdersList" style="display:none; margin-top:20px;"></div>
        </div>
    </div>

    <div id="rechargeModal" class="modal-overlay">
        <div class="modal-content">
            <h3 style="margin-bottom:20px;">Ø´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯</h3>
            <select id="rechargeMethod" style="margin-bottom:15px;">
                <option value="asia">ÙƒØ§Ø±Øª Ø¢Ø³ÙŠØ§ Ø³ÙŠÙ„</option>
                <option value="usdt">USDT - TRC20</option>
            </select>
            <input type="text" id="rechargeCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„ÙƒØ§Ø±Øª Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©">
            <button class="submit-btn" style="margin-top:20px;" onclick="submitRecharge()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
            <button onclick="closeModal('rechargeModal')" style="background:none; border:none; color:var(--danger); margin-top:15px; width:100%; cursor:pointer;">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <div id="ordersModal" class="modal-overlay">
        <div class="modal-content" style="max-height:80vh; overflow-y:auto;">
            <h3>Ø³Ø¬Ù„ Ø·Ù„Ø¨Ø§ØªÙŠ</h3>
            <div id="myOrders" style="margin-top:20px;"></div>
            <button onclick="closeModal('ordersModal')" class="submit-btn" style="margin-top:20px;">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div id="referralModal" class="modal-overlay">
        <div class="modal-content">
            <h3>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h3>
            <p style="font-size:12px; color:#8b949e; margin:15px 0;">Ø§Ø±Ø¨Ø­ 0.50$ Ø¹Ù† ÙƒÙ„ Ø´Ø®Øµ ÙŠØ´Ø­Ù† Ù…Ù† Ø®Ù„Ø§Ù„ Ø±Ø§Ø¨Ø·Ùƒ!</p>
            <div id="refLink" onclick="copyRef()" style="background:#000; padding:15px; border-radius:15px; font-size:11px; color:var(--main-color); border:1px solid var(--glass-border); cursor:pointer;"></div>
            <button onclick="closeModal('referralModal')" class="submit-btn" style="margin-top:20px;">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <script>
        // --- 1. Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ---
        const firebaseConfig = {
            apiKey: "AIzaSyDrLSVoJJsEzlmcIBvNNb9OJzWtJixYhpw",
            authDomain: "army-smm.firebaseapp.com",
            projectId: "army-smm",
            storageBucket: "army-smm.firebasestorage.app",
            messagingSenderId: "27268417960",
            appId: "1:27268417960:web:990e040e77a0c38a11f59d"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth(), db = firebase.firestore();

        // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø°ÙƒÙŠ ---
        const MASTER_KEY = "DARK_BOSS_2026_PRO"; 
        const URL_SECRET = "boss77";

        // ØªÙØ¹ÙŠÙ„ Ø¨ØµÙ…Ø© Ø§Ù„Ø¬Ù‡Ø§Ø² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ø¨Ø± Ø§Ù„Ø±Ø§Ø¨Ø· (Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±)
        const urlParams = new URLSearchParams(window.location.search);
        if(urlParams.get('activate') === MASTER_KEY) {
            localStorage.setItem('admin_secret_token', MASTER_KEY);
            alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø¨ØµÙ…Ø© Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¨Ù†Ø¬Ø§Ø­! âœ…");
        }

        const services = {
            tiktok: { "Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø¹Ø±Ø¨": 0.40, "Ù„Ø§ÙŠÙƒØ§Øª": 0.12, "Ù…Ø´Ø§Ù‡Ø¯Ø§Øª": 0.01 },
            instagram: { "Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø¶Ù…Ø§Ù†": 0.65, "Ù„Ø§ÙŠÙƒØ§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©": 0.20 },
            telegram: { "Ø£Ø¹Ø¶Ø§Ø¡ Ù‚Ù†ÙˆØ§Øª": 0.45, "Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ù…Ù†Ø´ÙˆØ±": 0.05 },
            youtube: { "Ù…Ø´ØªØ±ÙƒÙŠÙ†": 6.00, "Ø³Ø§Ø¹Ø§Øª Ù…Ø´Ø§Ù‡Ø¯Ø©": 14.00 }
        };

        let userProfile = null;

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                loadUserProfile(user.uid);
                loadLeaderboard();
            } else {
                document.getElementById('authScreen').style.display = 'flex';
                document.getElementById('mainContent').style.display = 'none';
            }
        });

        async function register() {
            const n = document.getElementById('regName').value, e = document.getElementById('regEmail').value, p = document.getElementById('regPass').value;
            if(!n || !e || p.length < 6) return showToast("Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ©");
            try {
                const res = await auth.createUserWithEmailAndPassword(e, p);
                const ref = new URLSearchParams(window.location.search).get('ref');
                await db.collection("users").doc(res.user.uid).set({
                    name: n, balance: 0.0, role: 'user', joined: new Date(), lastBonus: 0, referredBy: ref || null
                });
            } catch(err) { alert(err.message); }
        }

        async function login() {
            const e = document.getElementById('email').value, p = document.getElementById('pass').value;
            try { await auth.signInWithEmailAndPassword(e, p); } catch(err) { alert(err.message); }
        }

        function logout() { auth.signOut(); }

        function loadUserProfile(uid) {
            db.collection("users").doc(uid).onSnapshot(doc => {
                userProfile = doc.data();
                document.getElementById('balanceText').innerText = "$" + userProfile.balance.toFixed(2);
                document.getElementById('sideUserName').innerText = userProfile.name;
                document.getElementById('sideUserID').innerText = "ID: " + uid;
                document.getElementById('refLink').innerText = window.location.origin + window.location.pathname + "?ref=" + uid;
                
                // --- ÙØ­Øµ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ ---
                const hasUrlKey = urlParams.get('key') === URL_SECRET;
                const hasDeviceKey = localStorage.getItem('admin_secret_token') === MASTER_KEY;
                const isBossID = (uid === "Wf187vT9u8M3Q6R9h2Y7v5X1");

                if(isBossID && hasUrlKey && hasDeviceKey) {
                    document.getElementById('adminPanel').style.display = 'block';
                } else {
                    document.getElementById('adminPanel').style.display = 'none';
                }
            });
        }

        function updateServicesList() {
            const p = document.getElementById('platformSelect').value;
            const s = document.getElementById('serviceSelect');
            s.innerHTML = "";
            for (let name in services[p]) {
                s.innerHTML += `<option value="${services[p][name]}">${name} ($${services[p][name]})</option>`;
            }
            updatePrice();
        }

        function updatePrice() {
            const rate = parseFloat(document.getElementById('serviceSelect').value);
            const qty = parseInt(document.getElementById('orderQty').value) || 0;
            document.getElementById('totalPrice').innerText = ((qty / 1000) * rate).toFixed(2);
        }

        async function sendOrder() {
            const price = parseFloat(document.getElementById('totalPrice').innerText);
            const link = document.getElementById('orderLink').value;
            const qty = document.getElementById('orderQty').value;
            if(!link || qty < 10) return showToast("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ§Ù„ÙƒÙ…ÙŠØ©!");
            if(userProfile.balance < price) return showToast("Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙ!");

            await db.collection("orders").add({
                uid: auth.currentUser.uid, name: userProfile.name,
                service: document.getElementById('serviceSelect').selectedOptions[0].text,
                qty, link, price, status: 'pending', date: new Date()
            });
            await db.collection("users").doc(auth.currentUser.uid).update({
                balance: firebase.firestore.FieldValue.increment(-price)
            });
            showToast("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­ âœ…");
        }

        async function submitRecharge() {
            const code = document.getElementById('rechargeCode').value;
            if(!code) return showToast("Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø£ÙˆÙ„Ø§Ù‹!");
            await db.collection("recharge_requests").add({
                uid: auth.currentUser.uid, name: userProfile.name,
                method: document.getElementById('rechargeMethod').value,
                value: code, status: 'pending', date: new Date()
            });
            showToast("Ø¬Ø§Ø±ÙŠ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ");
            closeModal('rechargeModal');
        }

        async function claimDailyBonus() {
            const now = Date.now();
            if(now - (userProfile.lastBonus || 0) < 86400000) return showToast("Ø¹Ø¯ ØºØ¯Ø§Ù‹ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆÙ†Øµ!");
            await db.collection("users").doc(auth.currentUser.uid).update({
                balance: firebase.firestore.FieldValue.increment(0.05),
                lastBonus: now
            });
            showToast("Ø­ØµÙ„Øª Ø¹Ù„Ù‰ 0.05$ Ø¨ÙˆÙ†Øµ! ğŸ");
        }

        function toggleMenu() { document.getElementById('sideMenu').classList.toggle('active'); }
        function openModal(id) { document.getElementById(id).style.display = 'flex'; toggleMenu(); }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg; t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        }
        function loadLeaderboard() {
            db.collection("users").orderBy("balance", "desc").limit(5).get().then(snap => {
                const list = document.getElementById('leaderList');
                list.innerHTML = "";
                snap.forEach(doc => {
                    list.innerHTML += `<div class="leader-row"><span>${doc.data().name}</span><span style="color:var(--gold)">$${doc.data().balance.toFixed(2)}</span></div>`;
                });
            });
        }
        function switchAuth(isReg) {
            document.getElementById('loginForm').style.display = isReg ? 'none' : 'block';
            document.getElementById('registerForm').style.display = isReg ? 'block' : 'none';
        }

        updateServicesList();
    </script>
</body>
</html>
